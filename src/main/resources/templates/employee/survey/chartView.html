<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Survey Results</title>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h2>Survey Results</h2>
    <div id="chart_div" style="width: 600px; height: 400px;"></div>

    <script>
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            console.log("AJAX 요청 시작");
            $.ajax({
                url: '/employee/survey/chartView',
                method: 'GET',
                dataType: 'json',
                success: function(response) {
                    console.log("AJAX 응답:", response); // 응답 로그

                    var data = new google.visualization.DataTable();
                    data.addColumn('string', 'Answer');
                    data.addColumn('number', 'Votes');

                    response.forEach(function(item) {
                        data.addRow([item.label, item.value]);
                    });

                    var options = {
                        title: 'Survey Results',
                        width: 600,
                        height: 400
                    };

                    var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
                    chart.draw(data, options);
                },
                error: function(xhr, status, error) {
                    console.error("Error fetching chart data:", xhr.status, error);
                    console.error("Response Text:", xhr.responseText);
                }
            });
        }
    </script>
</body>
</html>
